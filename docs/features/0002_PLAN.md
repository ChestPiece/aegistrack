# Skeleton Loading & Dark Mode Toggle Implementation

## Overview

Implement two UI enhancements to improve user experience:

1. **Skeleton Loading States** - Add skeleton loading screens across all pages with async data fetching to provide better visual feedback during loading. Currently, all pages track loading state but only show empty states without skeleton screens, creating a poor user experience during data fetches.

2. **Dark/Light Mode Toggle** - Implement a theme switcher with localStorage persistence using the provided CSS theme variables. The application already has `:root` and `.dark` class definitions with OKLCH color values, but no UI control to switch between themes.

## Proposed Changes

### Skeleton Components

#### [NEW] [SkeletonLoaders.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/components/SkeletonLoaders.tsx)

Create reusable skeleton loader components for common patterns:

- **StatCardSkeleton** - For dashboard stat cards (4 cards in a row)
- **TaskCardSkeleton** - For task list items
- **ProjectCardSkeleton** - For project grid cards
- **TeamMemberSkeleton** - For team member cards
- **NotificationSkeleton** - For notification list items

Each skeleton component will:

- Use the existing `Skeleton` component from shadcn/ui
- Match the dimensions and layout of actual components
- Be wrapped in the same Card/container structure
- Include appropriate spacing and grid layouts

---

### Page Updates

#### [MODIFY] [UserDashboard.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/pages/UserDashboard.tsx)

Replace loading state logic:

- Show `StatCardSkeleton` (4 cards) while `loading === true`
- Show skeleton for Task Completion Rate card
- Show skeleton for Recent Tasks section
- Remove reliance on `loading` check in empty state (show empty when `!loading && tasks.length === 0`)

#### [MODIFY] [MyTasks.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/pages/MyTasks.tsx)

- Show 3-5 `TaskCardSkeleton` components while `loading === true`
- Remove loading check from empty state

#### [MODIFY] [MyProjects.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/pages/MyProjects.tsx)

- Show grid of 3-6 `ProjectCardSkeleton` components while `loading === true`
- Match responsive grid (md:grid-cols-2 lg:grid-cols-3)
- Remove loading check from empty state

---

### Admin Pages

#### [MODIFY] [AdminDashboard.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/pages/admin/AdminDashboard.tsx)

- Show `StatCardSkeleton` (4 cards) for stats section
- Show skeleton for Recent Projects section
- Show skeleton for Recent Tasks section

#### [MODIFY] [Tasks.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/pages/admin/Tasks.tsx)

- Show 3-5 `TaskCardSkeleton` components while loading

#### [MODIFY] [Projects.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/pages/admin/Projects.tsx)

- Show grid of 3-6 `ProjectCardSkeleton` components while loading

#### [MODIFY] [Team.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/pages/admin/Team.tsx)

- Show 3-5 `TeamMemberSkeleton` components while loading

---

---

### Common Pages

#### [MODIFY] [Notifications.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/pages/Notifications.tsx)

- Show 3-5 `NotificationSkeleton` components while loading
- Remove loading check from empty state

> [!NOTE]
> Auth pages (Login, Signup) and Profile page use button loading states with spinners, which is appropriate for form submissions. No skeleton loading needed for these pages.

---

## Dark Mode Toggle Implementation

### Theme Context & Provider

#### [NEW] [ThemeContext.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/contexts/ThemeContext.tsx)

Create a theme context to manage dark/light mode state:

- **useTheme hook** - Custom hook to access theme state and toggle function
- **ThemeProvider component** - Context provider that:
  - Manages theme state (`'light' | 'dark' | 'system'`)
  - Reads initial theme from localStorage
  - Applies `.dark` class to document root when theme is dark
  - Listens to system theme preference changes
  - Persists theme preference to localStorage
  - Provides `theme`, `setTheme`, and `toggleTheme` functions

#### [MODIFY] [App.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/App.tsx)

Wrap the application with `ThemeProvider`:

- Add ThemeProvider around QueryClientProvider (or inside it)
- Ensure theme is applied before rendering any components

### Theme Toggle UI

#### [NEW] [ThemeToggle.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/components/ThemeToggle.tsx)

Create a theme toggle button component:

- **Display** - Button or dropdown menu with Sun/Moon/Monitor icons
- **Options** - Light, Dark, System (follows OS preference)
- **Icons** - Use lucide-react: `Sun`, `Moon`, `Monitor`
- **Dropdown** - Use shadcn/ui DropdownMenu component
- **Current selection** - Show checkmark next to active theme

#### [MODIFY] [AppSidebar.tsx](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/components/layout/AppSidebar.tsx)

Add theme toggle to sidebar footer:

- Place `ThemeToggle` component in `SidebarFooter` above sign out button
- Show icon-only view when sidebar is collapsed
- Show full label view when sidebar is expanded

### CSS Theme Variables

#### [MODIFY] [index.css](file:///c:/Users/Anas/Desktop/aegistrack-project-hub/src/index.css)

Update CSS file with provided theme variables:

- Add complete `:root` CSS variables (already exists, verify completeness)
- Add complete `.dark` class CSS variables (already exists, verify completeness)
- Add `@theme inline` block with all theme tokens (already exists, verify completeness)
- Apply `letter-spacing: var(--tracking-normal)` to body (already exists)

> [!IMPORTANT]
> The CSS theme variables have already been provided by the user with OKLCH color values. Verify that `index.css` contains the complete `:root`, `.dark`, and `@theme inline` blocks exactly as provided.

---

## Implementation Strategy

1. **Create centralized skeleton components** - Single file with all reusable skeleton patterns
2. **Update pages systematically** - User pages first, then admin pages, then common pages
3. **Maintain consistent patterns** - All skeletons should use the `glass` class and match actual component styling
4. **Preserve empty states** - Keep empty state messages but remove loading conditions

## Verification Plan

### Automated Tests

No existing test suite found in the codebase. Skipping automated test creation for this feature.

### Manual Verification

1. **User Dashboard Testing:**

   - Navigate to `/dashboard` in network throttled mode (Chrome DevTools)
   - Verify 4 stat card skeletons appear
   - Verify skeleton for completion rate card appears
   - Verify skeleton for recent tasks section appears
   - Confirm skeletons disappear when data loads

2. **Tasks Page Testing:**

   - Navigate to `/tasks` with network throttling
   - Verify 3-5 task card skeletons appear in vertical list
   - Confirm skeleton cards match actual task card layout
   - Verify smooth transition to actual data

3. **Projects Page Testing:**

   - Navigate to `/projects` with throttling
   - Verify grid of skeleton project cards (responsive)
   - Confirm layout matches actual project cards
   - Test on mobile, tablet, desktop viewports

4. **Admin Pages Testing:**

   - Log in as admin user
   - Test `/admin/dashboard`, `/admin/tasks`, `/admin/projects`, `/admin/team`
   - Verify appropriate skeletons appear on each page
   - Confirm all skeletons use consistent styling

5. **Notifications Page Testing:**

   - Navigate to `/notifications`
   - Verify notification skeletons appear
   - Confirm empty state still works without loading data

6. **Design Consistency:**

   - Compare skeleton animations across all pages
   - Verify glass-morphism effect is applied
   - Check that skeleton dimensions match actual components
   - Ensure smooth fade-in animations when data loads

7. **Dark Mode Toggle Testing:**

   - Click theme toggle in sidebar
   - Verify dropdown shows Light, Dark, and System options
   - Select "Dark" and verify `.dark` class is applied to `<html>` element
   - Verify all colors change to dark theme (background, cards, text, sidebar)
   - Reload page and verify dark theme persists (localStorage)
   - Select "Light" and verify theme switches back
   - Select "System" and verify theme matches OS preference
   - Change OS theme and verify app theme updates automatically

8. **Theme Toggle UI:**
   - Collapse sidebar and verify theme toggle shows icon only
   - Expand sidebar and verify theme toggle shows current theme name
   - Verify checkmark appears next to active theme option
   - Test theme toggle on mobile viewport
   - Verify smooth transitions between themes (no flash)
